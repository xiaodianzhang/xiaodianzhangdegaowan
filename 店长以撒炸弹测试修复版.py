class åº—é•¿:
    ç‰¹ç‚¹ = "åªèƒ½ç”¨é’±å›å¤è‡ªå·±çš„è¡€é‡"
    def __init__(self,è¡€é‡,åå­—,ä¼¤å®³,å‡ å›åˆæ”»å‡»ä¸€æ¬¡,ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹):
        self._è¡€é‡ = è¡€é‡
        self.åå­— = åå­—
        self.ä¼¤å®³ = ä¼¤å®³
        self.å‡ å›åˆæ”»å‡»ä¸€æ¬¡ = å‡ å›åˆæ”»å‡»ä¸€æ¬¡
        self.ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹ = ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹
        self.æ”»å‡»å†·å´ = 0
    
    def æ”»å‡»(self, å…¶ä»–):
        print(f"{self.åå­—}æ”»å‡»äº†{å…¶ä»–.åå­—}")
        æ€»ä¼¤å®³ = self.ä¼¤å®³ * self.ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹
        print(f"{self.åå­—}é€ æˆäº†{æ€»ä¼¤å®³}ç‚¹ä¼¤å®³")    
        å…¶ä»–.è¡€é‡ -= æ€»ä¼¤å®³
        print(f"{å…¶ä»–.åå­—}è¿˜å‰©{å…¶ä»–.è¡€é‡}ç‚¹è¡€é‡")
        if å…¶ä»–.è¡€é‡ <= 0:
            print(f"{å…¶ä»–.åå­—}æ­»äº†ğŸ˜±")
    
    def __sub__(self, å…¶ä»–):
        self.æ”»å‡»(å…¶ä»–)
    
    def __str__(self):
        return f"{self.åå­—} è¡€é‡:{self.è¡€é‡} æ”»å‡»å†·å´:{self.æ”»å‡»å†·å´}"
    
    def å¯ä»¥æ”»å‡»(self):
        if not self.æ˜¯å¦å­˜æ´»:
            return False
            
        if self.æ”»å‡»å†·å´ == 0:
            self.æ”»å‡»å†·å´ = self.å‡ å›åˆæ”»å‡»ä¸€æ¬¡
            return True
        elif self.æ”»å‡»å†·å´ > 0:
            print(f"æœ¬å›åˆ{self.åå­—}æ— æ³•æ”»å‡»ï¼Œå†·å´å‰©ä½™:{self.æ”»å‡»å†·å´}")
            self.æ”»å‡»å†·å´ -= 1
            return False
        return True
    
    @property
    def è¡€é‡(self):
        return self._è¡€é‡
    
    @è¡€é‡.setter
    def è¡€é‡(self, å€¼):
        if å€¼ < 0:
            self._è¡€é‡ = 0
        else:
            self._è¡€é‡ = å€¼
    
    @property
    def æ˜¯å¦å­˜æ´»(self):
        return self._è¡€é‡ > 0


class æˆ˜æ–—:
    def __init__(self, a, b):
        self.a = a
        self.b = b
        self.å½“å‰å›åˆ = 0
    
    def __enter__(self):
        print("=" * 30)
        print(f"{self.a.åå­—} vs {self.b.åå­—}")
        print(f"{self.a.åå­—}: {self.a.ç‰¹ç‚¹}")
        print(f"{self.b.åå­—}: {self.b.ç‰¹ç‚¹}")
        print("=" * 30)
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        print("=" * 30)
        print("æˆ˜æ–—ç»“æŸ!")
        if self.a.æ˜¯å¦å­˜æ´»:
            print(f"èƒœåˆ©è€…: {self.a.åå­—}")
        else:
            print(f"èƒœåˆ©è€…: {self.b.åå­—}")
        print("=" * 30)
        return False
    
    def å›åˆ(self):
        self.å½“å‰å›åˆ += 1
        print("\n" + "=" * 20)
        print(f"ç¬¬{self.å½“å‰å›åˆ}å›åˆ")
        
        # è®¡ç®—çˆ†ç‚¸æ•ˆæœ
        if hasattr(self.a, 'è®¡ç®—çˆ†ç‚¸'):
            self.a.è®¡ç®—çˆ†ç‚¸()
        if hasattr(self.b, 'è®¡ç®—çˆ†ç‚¸'):
            self.b.è®¡ç®—çˆ†ç‚¸()
        
        # æ£€æŸ¥æ˜¯å¦æœ‰äººæ­»äº¡
        if not self.a.æ˜¯å¦å­˜æ´» or not self.b.æ˜¯å¦å­˜æ´»:
            return False
        
        # Aæ”»å‡»B
        if self.a.å¯ä»¥æ”»å‡»() and self.a.æ˜¯å¦å­˜æ´»:
            self.a.æ”»å‡»(self.b)
        
        # æ£€æŸ¥Bæ˜¯å¦æ­»äº¡
        if not self.b.æ˜¯å¦å­˜æ´»:
            return False
        
        # Bæ”»å‡»A
        if self.b.å¯ä»¥æ”»å‡»() and self.b.æ˜¯å¦å­˜æ´»:
            self.b.æ”»å‡»(self.a)
        
        # æ£€æŸ¥Aæ˜¯å¦æ­»äº¡
        if not self.a.æ˜¯å¦å­˜æ´»:
            return False
        
        return True


class ä»¥æ’’(åº—é•¿):
    ç‰¹ç‚¹ = "è‡ªå¸¦ä¸€é¢—ç‚¸å¼¹ğŸ’£"
    
    def __init__(self, è¡€é‡, åå­—, ä¼¤å®³, å‡ å›åˆæ”»å‡»ä¸€æ¬¡, ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹):
        super().__init__(è¡€é‡, åå­—, ä¼¤å®³, å‡ å›åˆæ”»å‡»ä¸€æ¬¡, ä¸€æ¬¡å‘å°„å‡ é¢—å­å¼¹)
        self.ç‚¸å¼¹æ•°é‡ = 1
        self.ç‚¸å¼¹ä¼¤å®³ = 10
        self.ç‚¸å¼¹å€’è®¡æ—¶ = 0
        self.çˆ†ç‚¸æ—¶é—´ = 3
        self.ç‚¸å¼¹ç›®æ ‡ = None
        self.å·²æ”¾ç½®ç‚¸å¼¹ = False
    
    def ä½¿ç”¨ç‚¸å¼¹(self, ç›®æ ‡):
        if self.ç‚¸å¼¹æ•°é‡ <= 0:
            print(f"{self.åå­—}: æ²¡æœ‰ç‚¸å¼¹äº†ï¼")
            return False
        
        if self.å·²æ”¾ç½®ç‚¸å¼¹:
            print(f"{self.åå­—}: å·²æ”¾ç½®ç‚¸å¼¹ï¼Œæ— æ³•é‡å¤æ”¾ç½®")
            return False
        
        self.ç‚¸å¼¹æ•°é‡ -= 1
        self.å·²æ”¾ç½®ç‚¸å¼¹ = True
        self.ç‚¸å¼¹ç›®æ ‡ = ç›®æ ‡
        self.ç‚¸å¼¹å€’è®¡æ—¶ = self.çˆ†ç‚¸æ—¶é—´
        print(f"{self.åå­—}åœ¨{ç›®æ ‡.åå­—}èº«ä¸Šæ”¾ç½®äº†ç‚¸å¼¹ğŸ’£ ({self.ç‚¸å¼¹å€’è®¡æ—¶}å›åˆåçˆ†ç‚¸)")
        return True
    
    def è®¡ç®—çˆ†ç‚¸(self):
        if not self.å·²æ”¾ç½®ç‚¸å¼¹ or self.ç‚¸å¼¹ç›®æ ‡ is None:
            return False
        
        self.ç‚¸å¼¹å€’è®¡æ—¶ -= 1
        if self.ç‚¸å¼¹å€’è®¡æ—¶ > 0:
            print(f"ğŸ’£ç‚¸å¼¹è¿˜æœ‰{self.ç‚¸å¼¹å€’è®¡æ—¶}å›åˆçˆ†ç‚¸")
            return False
        else:
            print("ğŸ’£ğŸ’¥ç‚¸å¼¹çˆ†ç‚¸äº†ï¼")
            print(f"{self.ç‚¸å¼¹ç›®æ ‡.åå­—}å—åˆ°{self.ç‚¸å¼¹ä¼¤å®³}ç‚¹æ— è§†æŠ¤ç”²çš„ä¼¤å®³")
            self.ç‚¸å¼¹ç›®æ ‡.è¡€é‡ -= self.ç‚¸å¼¹ä¼¤å®³
            self.å·²æ”¾ç½®ç‚¸å¼¹ = False
            self.ç‚¸å¼¹ç›®æ ‡ = None
            return True
    
    def æ”»å‡»(self, ç›®æ ‡):
        if self.ç‚¸å¼¹æ•°é‡ > 0 and not self.å·²æ”¾ç½®ç‚¸å¼¹:
            if self.ä½¿ç”¨ç‚¸å¼¹(ç›®æ ‡):
                self.æ”»å‡»å†·å´ = self.å‡ å›åˆæ”»å‡»ä¸€æ¬¡
        else:
            super().æ”»å‡»(ç›®æ ‡)
            self.æ”»å‡»å†·å´ = self.å‡ å›åˆæ”»å‡»ä¸€æ¬¡
    
    def __str__(self):
        base_info = super().__str__()
        ç‚¸å¼¹çŠ¶æ€ = ""
        if self.å·²æ”¾ç½®ç‚¸å¼¹ and self.ç‚¸å¼¹ç›®æ ‡:
            ç‚¸å¼¹çŠ¶æ€ = f" ç‚¸å¼¹å€’è®¡æ—¶:{self.ç‚¸å¼¹å€’è®¡æ—¶}"
        return f"{base_info} ç‚¸å¼¹:{self.ç‚¸å¼¹æ•°é‡}é¢—{ç‚¸å¼¹çŠ¶æ€}"


# ========== æµ‹è¯•æˆ˜æ–— ==========
if __name__ == "__main__":
    print("ã€æµ‹è¯•1: æ™®é€šåº—é•¿å¯¹æˆ˜ã€‘")
    å°åº—é•¿ = åº—é•¿(30, "å°åº—é•¿", 3, 2, 3)
    å •åŒ–åº—é•¿ = åº—é•¿(20, "å •åŒ–åº—é•¿", 3, 3, 4)
    
    with æˆ˜æ–—(å°åº—é•¿, å •åŒ–åº—é•¿) as æˆ˜æ–—aa:
        æˆ˜æ–—ç»§ç»­ = True
        while æˆ˜æ–—ç»§ç»­:
            æˆ˜æ–—ç»§ç»­ = æˆ˜æ–—aa.å›åˆ()
    
    print("\n" * 2 + "ã€æµ‹è¯•2: ä»¥æ’’å¯¹æˆ˜ã€‘")
    å°ä»¥æ’’ = ä»¥æ’’(60, "å°ä»¥æ’’", 1, 1, 1)
    æ–°åº—é•¿ = åº—é•¿(40, "æµ‹è¯•åº—é•¿", 2, 1, 2)
    
    print(å°ä»¥æ’’)
    print(æ–°åº—é•¿)
    
    with æˆ˜æ–—(å°ä»¥æ’’, æ–°åº—é•¿) as æˆ˜æ–—aa:
        æˆ˜æ–—ç»§ç»­ = True
        while æˆ˜æ–—ç»§ç»­:
            æˆ˜æ–—ç»§ç»­ = æˆ˜æ–—aa.å›åˆ()